{% extends "base.html" %}
{% block title %}{{ patient.given }} {{ patient.family }} â€” Doctor{% endblock %}
{% block content %}
<div class="d-flex justify-content-between mb-3">
  <h4>Patient: {{ patient.given }} {{ patient.family }} <small class="text-muted">({{ patient.identifier }})</small></h4>
  <div>
    <a class="btn btn-outline-secondary me-2" href="{% url 'patient:doctor_dashboard' %}">Back</a>
    <a class="btn btn-primary" href="{% url 'patient:observation_add' patient.id %}">Add Observation</a>
  </div>
</div>

<div class="card p-3 mb-3">
  <div><strong>Phone:</strong> {{ patient.phone }}</div>
  <div><strong>Address:</strong> {{ patient.address }}</div>
</div>

<div class="card p-3">
  <h5>Records</h5>
  <table class="table">
    <thead><tr><th>Date</th><th>Code</th><th>Value</th><th>Performer</th><th></th></tr></thead>
    <tbody>
      {% for r in records %}
      <tr>
        <td>{{ r.effective_date|date:"Y-m-d H:i" }}</td>
        <td>{{ r.code }}</td>
        <td>{{ r.value }} {% if r.unit %}{{ r.unit }}{% endif %}</td>
        <td>{{ r.performer }}</td>
        <!-- <td>{{ r.remarks|truncatechars:80 }}</td> -->
        <!-- <td><a class="btn btn-sm btn-outline-secondary" href="{% url 'patient:observation_edit' patient.id r.id %}">Edit</a></td> -->
      </tr>
      {% empty %}
      <tr><td colspan="5" class="text-muted">No records available.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
